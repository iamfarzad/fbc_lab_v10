#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Check for secrets FIRST (critical!)
echo "ğŸ”’ Checking for secrets..."
node scripts/check-secrets.js || {
  echo "âŒ SECRETS DETECTED! Commit blocked."
  echo "   Remove secrets before committing."
  exit 1
}

# Run type checking
echo "ğŸ” Running type check..."
pnpm type-check || {
  echo "âŒ Type check failed. Please fix errors before committing."
  exit 1
}

# Run linting
echo "ğŸ” Running linter..."
pnpm lint || {
  echo "âŒ Linting failed. Run 'pnpm lint:fix' to auto-fix issues."
  exit 1
}

# Check for circular dependencies
echo "ğŸ” Checking for circular dependencies..."
pnpm check:circular || {
  echo "âš ï¸  Circular dependencies detected. Review before committing."
  # Don't fail, just warn
}

echo "âœ… Pre-commit checks passed!"

